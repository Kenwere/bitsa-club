RewriteEngine On

# Redirect to HTTPS if not localhost
# RewriteCond %{HTTPS} off
# RewriteCond %{HTTP_HOST} !localhost
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remove trailing slash
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /$1 [L,R=301]

# Front controller pattern - redirect all requests to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]

# API routes
RewriteRule ^api/posts$ api/posts.php [L]
RewriteRule ^api/meetings$ api/meetings.php [L]
RewriteRule ^api/events$ api/events.php [L]
RewriteRule ^api/profile$ api/profile.php [L]

# Auth routes
RewriteRule ^login$ auth/user-login.php [L]
RewriteRule ^register$ auth/user-register.php [L]
RewriteRule ^admin/login$ auth/admin-login.php [L]
RewriteRule ^admin/register$ auth/admin-register.php [L]

# User routes
RewriteRule ^dashboard$ user/dashboard.php [L]
RewriteRule ^profile$ user/profile.php [L]

# Admin routes
RewriteRule ^admin/dashboard$ admin/dashboard.php [L]

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"